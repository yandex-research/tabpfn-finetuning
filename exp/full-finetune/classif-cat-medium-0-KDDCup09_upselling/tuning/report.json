{
    "function": "bin.tune.main",
    "gpus": [
        "NVIDIA A100-SXM4-80GB"
    ],
    "config": {
        "seed": 0,
        "function": "bin.tabpfnv2_finetune.main",
        "n_trials": 10,
        "sampler_type": "BruteForceSampler",
        "space": {
            "seed": 0,
            "patience": 16,
            "amp": true,
            "n_epochs": -1,
            "batch_size": 1,
            "epoch_size": 10,
            "seq_len_pred": 1024,
            "finetune_mode": "full",
            "model": {
                "untie_pos_embeddings": false,
                "untie_value_embeddings": false,
                "tabpfn_config": {
                    "nhead": 6,
                    "emsize": 192,
                    "nlayers": 12,
                    "nhid_factor": 4
                },
                "num_embeddings": {
                    "type": "LinearEmbeddings"
                }
            },
            "data": {
                "seed": 0,
                "num_policy": "noisy-quantile",
                "cache": true,
                "path": ":data/classif-cat-medium-0-KDDCup09_upselling",
                "cat_policy": "ordinal",
                "old": true
            },
            "optimizer": {
                "type": "AdamW",
                "lr": [
                    "_tune_",
                    "categorical",
                    [
                        4.999998054699972e-06,
                        8.340500244230498e-06,
                        1.3912793292547576e-05,
                        2.320794010302052e-05,
                        3.871318040182814e-05,
                        6.457747804233804e-05,
                        0.00010772173118311912,
                        0.00017969068721868098,
                        0.00029974215431138873,
                        0.0005000000819563866
                    ]
                ],
                "weight_decay": 0.0
            }
        }
    },
    "best": {
        "function": "bin.tabpfnv2_finetune.main",
        "gpus": [
            "NVIDIA A100-SXM4-80GB"
        ],
        "config": {
            "seed": 0,
            "patience": 16,
            "amp": true,
            "n_epochs": -1,
            "batch_size": 1,
            "epoch_size": 10,
            "seq_len_pred": 1024,
            "finetune_mode": "full",
            "model": {
                "untie_pos_embeddings": false,
                "untie_value_embeddings": false,
                "tabpfn_config": {
                    "nhead": 6,
                    "emsize": 192,
                    "nlayers": 12,
                    "nhid_factor": 4
                },
                "num_embeddings": {
                    "type": "LinearEmbeddings"
                }
            },
            "data": {
                "seed": 0,
                "num_policy": "noisy-quantile",
                "cache": true,
                "path": ":data/classif-cat-medium-0-KDDCup09_upselling",
                "cat_policy": "ordinal",
                "old": true
            },
            "optimizer": {
                "type": "AdamW",
                "lr": 0.00017969068721868098,
                "weight_decay": 0.0
            }
        },
        "n_parameters": 7243978,
        "prediction_type": "probs",
        "metrics": {
            "train": {
                "0": {
                    "precision": 0.7681093394077448,
                    "recall": 0.9335548172757475,
                    "f1-score": 0.8427893026743314,
                    "support": 1806.0
                },
                "1": {
                    "precision": 0.9139167862266858,
                    "recall": 0.7145260796410544,
                    "f1-score": 0.8020144790683035,
                    "support": 1783.0
                },
                "accuracy": 0.8247422680412371,
                "macro avg": {
                    "precision": 0.8410130628172153,
                    "recall": 0.824040448458401,
                    "f1-score": 0.8224018908713174,
                    "support": 3589.0
                },
                "weighted avg": {
                    "precision": 0.840545861469091,
                    "recall": 0.8247422680412371,
                    "f1-score": 0.822532542994881,
                    "support": 3589.0
                },
                "cross-entropy": 0.30688526269410615,
                "roc-auc": 0.9323175878498107,
                "score": 0.8247422680412371
            },
            "val": {
                "0": {
                    "precision": 0.75,
                    "recall": 0.9230769230769231,
                    "f1-score": 0.8275862068965517,
                    "support": 208.0
                },
                "1": {
                    "precision": 0.9211822660098522,
                    "recall": 0.7450199203187251,
                    "f1-score": 0.8237885462555066,
                    "support": 251.0
                },
                "accuracy": 0.8257080610021786,
                "macro avg": {
                    "precision": 0.8355911330049262,
                    "recall": 0.8340484216978241,
                    "f1-score": 0.8256873765760291,
                    "support": 459.0
                },
                "weighted avg": {
                    "precision": 0.8436094744411176,
                    "recall": 0.8257080610021786,
                    "f1-score": 0.8255094905111435,
                    "support": 459.0
                },
                "cross-entropy": 0.32973913963946117,
                "roc-auc": 0.924341097149862,
                "score": 0.8257080610021786
            },
            "test": {
                "0": {
                    "precision": 0.7694704049844237,
                    "recall": 0.9014598540145985,
                    "f1-score": 0.8302521008403362,
                    "support": 548.0
                },
                "1": {
                    "precision": 0.8755760368663594,
                    "recall": 0.7196969696969697,
                    "f1-score": 0.7900207900207901,
                    "support": 528.0
                },
                "accuracy": 0.8122676579925651,
                "macro avg": {
                    "precision": 0.8225232209253915,
                    "recall": 0.8105784118557842,
                    "f1-score": 0.8101364454305631,
                    "support": 1076.0
                },
                "weighted avg": {
                    "precision": 0.8215371091049274,
                    "recall": 0.8122676579925651,
                    "f1-score": 0.8105103423712652,
                    "support": 1076.0
                },
                "cross-entropy": 0.4000896341182459,
                "roc-auc": 0.9031619802034947,
                "score": 0.8122676579925651
            }
        },
        "zero-shot-metrics": {
            "val": {
                "0": {
                    "precision": 0.7665198237885462,
                    "recall": 0.8365384615384616,
                    "f1-score": 0.8,
                    "support": 208.0
                },
                "1": {
                    "precision": 0.853448275862069,
                    "recall": 0.7888446215139442,
                    "f1-score": 0.8198757763975155,
                    "support": 251.0
                },
                "accuracy": 0.8104575163398693,
                "macro avg": {
                    "precision": 0.8099840498253076,
                    "recall": 0.8126915415262028,
                    "f1-score": 0.8099378881987578,
                    "support": 459.0
                },
                "weighted avg": {
                    "precision": 0.814055861850538,
                    "recall": 0.8104575163398693,
                    "f1-score": 0.8108688886182492,
                    "support": 459.0
                },
                "cross-entropy": 0.3216978589594275,
                "roc-auc": 0.9224448360404536,
                "score": 0.8104575163398693
            },
            "test": {
                "0": {
                    "precision": 0.7745571658615137,
                    "recall": 0.8777372262773723,
                    "f1-score": 0.8229255774165953,
                    "support": 548.0
                },
                "1": {
                    "precision": 0.8527472527472527,
                    "recall": 0.7348484848484849,
                    "f1-score": 0.7894201424211598,
                    "support": 528.0
                },
                "accuracy": 0.8076208178438662,
                "macro avg": {
                    "precision": 0.8136522093043832,
                    "recall": 0.8062928555629285,
                    "f1-score": 0.8061728599188775,
                    "support": 1076.0
                },
                "weighted avg": {
                    "precision": 0.8129255356344414,
                    "recall": 0.8076208178438662,
                    "f1-score": 0.8064842487199504,
                    "support": 1076.0
                },
                "cross-entropy": 0.3792574681717681,
                "roc-auc": 0.9072557232913072,
                "score": 0.8076208178438662
            }
        },
        "train": {
            "metrics": {
                "val": {
                    "0": {
                        "precision": 0.7509727626459144,
                        "recall": 0.9278846153846154,
                        "f1-score": 0.8301075268817204,
                        "support": 208.0
                    },
                    "1": {
                        "precision": 0.9257425742574258,
                        "recall": 0.7450199203187251,
                        "f1-score": 0.82560706401766,
                        "support": 251.0
                    },
                    "accuracy": 0.8278867102396514,
                    "macro avg": {
                        "precision": 0.83835766845167,
                        "recall": 0.8364522678516703,
                        "f1-score": 0.8278572954496902,
                        "support": 459.0
                    },
                    "weighted avg": {
                        "precision": 0.8465440539628848,
                        "recall": 0.8278867102396514,
                        "f1-score": 0.8276464894549684,
                        "support": 459.0
                    },
                    "cross-entropy": 0.3297455067756452,
                    "roc-auc": 0.9247912197364389,
                    "score": 0.8278867102396514
                },
                "train": {}
            },
            "best_step": 140
        },
        "time": "0:02:21.405734",
        "chunk_size": null,
        "eval_batch_size": 4096,
        "trial_id": 1,
        "tuning_time": "0:03:43.011902"
    },
    "time": "0:17:04.266196",
    "n_completed_trials": 10
}
