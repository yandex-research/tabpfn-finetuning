{
    "function": "bin.tune.main",
    "gpus": [
        "NVIDIA A100-SXM4-80GB"
    ],
    "config": {
        "seed": 0,
        "function": "bin.tabpfnv2_finetune.main",
        "n_trials": 10,
        "sampler_type": "BruteForceSampler",
        "space": {
            "seed": 0,
            "patience": 16,
            "amp": true,
            "n_epochs": -1,
            "batch_size": 1,
            "epoch_size": 10,
            "seq_len_pred": 512,
            "finetune_mode": "full",
            "model": {
                "untie_pos_embeddings": false,
                "untie_value_embeddings": false,
                "tabpfn_config": {
                    "nhead": 6,
                    "emsize": 192,
                    "nlayers": 12,
                    "nhid_factor": 4
                },
                "num_embeddings": {
                    "type": "LinearEmbeddings"
                }
            },
            "data": {
                "seed": 0,
                "num_policy": "noisy-quantile",
                "cache": true,
                "path": ":data/classif-num-medium-2-phoneme",
                "old": true
            },
            "optimizer": {
                "type": "AdamW",
                "lr": [
                    "_tune_",
                    "categorical",
                    [
                        4.999998054699972e-06,
                        8.340500244230498e-06,
                        1.3912793292547576e-05,
                        2.320794010302052e-05,
                        3.871318040182814e-05,
                        6.457747804233804e-05,
                        0.00010772173118311912,
                        0.00017969068721868098,
                        0.00029974215431138873,
                        0.0005000000819563866
                    ]
                ],
                "weight_decay": 0.0
            }
        }
    },
    "best": {
        "function": "bin.tabpfnv2_finetune.main",
        "gpus": [
            "NVIDIA A100-SXM4-80GB"
        ],
        "config": {
            "seed": 0,
            "patience": 16,
            "amp": true,
            "n_epochs": -1,
            "batch_size": 1,
            "epoch_size": 10,
            "seq_len_pred": 512,
            "finetune_mode": "full",
            "model": {
                "untie_pos_embeddings": false,
                "untie_value_embeddings": false,
                "tabpfn_config": {
                    "nhead": 6,
                    "emsize": 192,
                    "nlayers": 12,
                    "nhid_factor": 4
                },
                "num_embeddings": {
                    "type": "LinearEmbeddings"
                }
            },
            "data": {
                "seed": 0,
                "num_policy": "noisy-quantile",
                "cache": true,
                "path": ":data/classif-num-medium-2-phoneme",
                "old": true
            },
            "optimizer": {
                "type": "AdamW",
                "lr": 2.320794010302052e-05,
                "weight_decay": 0.0
            }
        },
        "n_parameters": 7243978,
        "prediction_type": "probs",
        "metrics": {
            "train": {
                "0": {
                    "precision": 0.9947183098591549,
                    "recall": 0.9903593339176161,
                    "f1-score": 0.9925340360122968,
                    "support": 1141.0
                },
                "1": {
                    "precision": 0.9898523985239852,
                    "recall": 0.9944392956441149,
                    "f1-score": 0.9921405455386038,
                    "support": 1079.0
                },
                "accuracy": 0.9923423423423423,
                "macro avg": {
                    "precision": 0.99228535419157,
                    "recall": 0.9923993147808655,
                    "f1-score": 0.9923372907754503,
                    "support": 2220.0
                },
                "weighted avg": {
                    "precision": 0.9923533016021061,
                    "recall": 0.9923423423423423,
                    "f1-score": 0.9923427854622451,
                    "support": 2220.0
                },
                "cross-entropy": 0.03370219955628776,
                "roc-auc": 0.9997802847606972,
                "score": 0.9923423423423423
            },
            "val": {
                "0": {
                    "precision": 0.9147286821705426,
                    "recall": 0.8613138686131386,
                    "f1-score": 0.8872180451127819,
                    "support": 137.0
                },
                "1": {
                    "precision": 0.8782051282051282,
                    "recall": 0.9256756756756757,
                    "f1-score": 0.9013157894736842,
                    "support": 148.0
                },
                "accuracy": 0.8947368421052632,
                "macro avg": {
                    "precision": 0.8964669051878353,
                    "recall": 0.8934947721444071,
                    "f1-score": 0.894266917293233,
                    "support": 285.0
                },
                "weighted avg": {
                    "precision": 0.8957620646727135,
                    "recall": 0.8947368421052632,
                    "f1-score": 0.8945389790265137,
                    "support": 285.0
                },
                "cross-entropy": 0.2841122282015575,
                "roc-auc": 0.9510751627539948,
                "score": 0.8947368421052632
            },
            "test": {
                "0": {
                    "precision": 0.893687707641196,
                    "recall": 0.8733766233766234,
                    "f1-score": 0.8834154351395731,
                    "support": 308.0
                },
                "1": {
                    "precision": 0.8934426229508197,
                    "recall": 0.9108635097493036,
                    "f1-score": 0.9020689655172414,
                    "support": 359.0
                },
                "accuracy": 0.8935532233883059,
                "macro avg": {
                    "precision": 0.8935651652960078,
                    "recall": 0.8921200665629635,
                    "f1-score": 0.8927422003284072,
                    "support": 667.0
                },
                "weighted avg": {
                    "precision": 0.8935557954915032,
                    "recall": 0.8935532233883059,
                    "f1-score": 0.8934553412948698,
                    "support": 667.0
                },
                "cross-entropy": 0.2881913593149936,
                "roc-auc": 0.9553051405419094,
                "score": 0.8935532233883059
            }
        },
        "zero-shot-metrics": {
            "val": {
                "0": {
                    "precision": 0.8947368421052632,
                    "recall": 0.8686131386861314,
                    "f1-score": 0.8814814814814815,
                    "support": 137.0
                },
                "1": {
                    "precision": 0.881578947368421,
                    "recall": 0.9054054054054054,
                    "f1-score": 0.8933333333333333,
                    "support": 148.0
                },
                "accuracy": 0.887719298245614,
                "macro avg": {
                    "precision": 0.888157894736842,
                    "recall": 0.8870092720457684,
                    "f1-score": 0.8874074074074074,
                    "support": 285.0
                },
                "weighted avg": {
                    "precision": 0.8879039704524468,
                    "recall": 0.887719298245614,
                    "f1-score": 0.8876361273554256,
                    "support": 285.0
                },
                "cross-entropy": 0.25906117036695164,
                "roc-auc": 0.9589662655356086,
                "score": 0.887719298245614
            },
            "test": {
                "0": {
                    "precision": 0.8929765886287625,
                    "recall": 0.8668831168831169,
                    "f1-score": 0.8797364085667215,
                    "support": 308.0
                },
                "1": {
                    "precision": 0.8885869565217391,
                    "recall": 0.9108635097493036,
                    "f1-score": 0.8995873452544704,
                    "support": 359.0
                },
                "accuracy": 0.8905547226386806,
                "macro avg": {
                    "precision": 0.8907817725752508,
                    "recall": 0.8888733133162103,
                    "f1-score": 0.889661876910596,
                    "support": 667.0
                },
                "weighted avg": {
                    "precision": 0.8906139530569164,
                    "recall": 0.8905547226386806,
                    "f1-score": 0.8904207957794679,
                    "support": 667.0
                },
                "cross-entropy": 0.27207465749464865,
                "roc-auc": 0.9586649423000397,
                "score": 0.8905547226386806
            }
        },
        "train": {
            "metrics": {
                "val": {
                    "0": {
                        "precision": 0.9147286821705426,
                        "recall": 0.8613138686131386,
                        "f1-score": 0.8872180451127819,
                        "support": 137.0
                    },
                    "1": {
                        "precision": 0.8782051282051282,
                        "recall": 0.9256756756756757,
                        "f1-score": 0.9013157894736842,
                        "support": 148.0
                    },
                    "accuracy": 0.8947368421052632,
                    "macro avg": {
                        "precision": 0.8964669051878353,
                        "recall": 0.8934947721444071,
                        "f1-score": 0.894266917293233,
                        "support": 285.0
                    },
                    "weighted avg": {
                        "precision": 0.8957620646727135,
                        "recall": 0.8947368421052632,
                        "f1-score": 0.8945389790265137,
                        "support": 285.0
                    },
                    "cross-entropy": 0.2886805248520772,
                    "roc-auc": 0.9500887749062932,
                    "score": 0.8947368421052632
                },
                "train": {}
            },
            "best_step": 80
        },
        "time": "0:00:26.444246",
        "chunk_size": null,
        "eval_batch_size": 4096,
        "trial_id": 3,
        "tuning_time": "0:01:55.484597"
    },
    "time": "0:04:24.471894",
    "n_completed_trials": 10
}
