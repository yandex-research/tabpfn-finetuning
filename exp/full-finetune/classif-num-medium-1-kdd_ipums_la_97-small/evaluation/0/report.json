{
    "function": "bin.tabpfnv2_finetune.main",
    "gpus": [
        "NVIDIA A100-SXM4-80GB"
    ],
    "config": {
        "seed": 0,
        "patience": 16,
        "amp": true,
        "n_epochs": -1,
        "batch_size": 1,
        "epoch_size": 10,
        "seq_len_pred": 1024,
        "finetune_mode": "full",
        "model": {
            "untie_pos_embeddings": false,
            "untie_value_embeddings": false,
            "tabpfn_config": {
                "nhead": 6,
                "emsize": 192,
                "nlayers": 12,
                "nhid_factor": 4
            },
            "num_embeddings": {
                "type": "LinearEmbeddings"
            }
        },
        "data": {
            "seed": 0,
            "num_policy": "noisy-quantile",
            "cache": true,
            "path": ":data/classif-num-medium-1-kdd_ipums_la_97-small",
            "old": true
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 6.457747804233804e-05,
            "weight_decay": 0.0
        }
    },
    "n_parameters": 7243978,
    "prediction_type": "probs",
    "metrics": {
        "train": {
            "0": {
                "precision": 0.9705304518664047,
                "recall": 0.8242491657397107,
                "f1-score": 0.8914285714285715,
                "support": 1798.0
            },
            "1": {
                "precision": 0.8498098859315589,
                "recall": 0.9754500818330606,
                "f1-score": 0.9083058166116332,
                "support": 1833.0
            },
            "accuracy": 0.9005783530707794,
            "macro avg": {
                "precision": 0.9101701688989818,
                "recall": 0.8998496237863857,
                "f1-score": 0.8998671940201024,
                "support": 3631.0
            },
            "weighted avg": {
                "precision": 0.9095883429821932,
                "recall": 0.9005783530707794,
                "f1-score": 0.8999485357415851,
                "support": 3631.0
            },
            "cross-entropy": 0.23384069130366306,
            "roc-auc": 0.9590205095435493,
            "score": 0.9005783530707794
        },
        "val": {
            "0": {
                "precision": 0.9528301886792453,
                "recall": 0.8744588744588745,
                "f1-score": 0.9119638826185101,
                "support": 231.0
            },
            "1": {
                "precision": 0.8862745098039215,
                "recall": 0.9576271186440678,
                "f1-score": 0.9205702647657841,
                "support": 236.0
            },
            "accuracy": 0.9164882226980728,
            "macro avg": {
                "precision": 0.9195523492415834,
                "recall": 0.9160429965514711,
                "f1-score": 0.9162670736921471,
                "support": 467.0
            },
            "weighted avg": {
                "precision": 0.9191960554574543,
                "recall": 0.9164882226980728,
                "f1-score": 0.9163131464017149,
                "support": 467.0
            },
            "cross-entropy": 0.2327584260497376,
            "roc-auc": 0.9565265243231345,
            "score": 0.9164882226980728
        },
        "test": {
            "0": {
                "precision": 0.9397590361445783,
                "recall": 0.8283185840707965,
                "f1-score": 0.8805268109125117,
                "support": 565.0
            },
            "1": {
                "precision": 0.8361486486486487,
                "recall": 0.9428571428571428,
                "f1-score": 0.8863025962399284,
                "support": 525.0
            },
            "accuracy": 0.8834862385321101,
            "macro avg": {
                "precision": 0.8879538423966136,
                "recall": 0.8855878634639697,
                "f1-score": 0.8834147035762201,
                "support": 1090.0
            },
            "weighted avg": {
                "precision": 0.8898549504240618,
                "recall": 0.8834862385321101,
                "f1-score": 0.8833087258637904,
                "support": 1090.0
            },
            "cross-entropy": 0.26219684360379625,
            "roc-auc": 0.9470122208175306,
            "score": 0.8834862385321101
        }
    },
    "zero-shot-metrics": {
        "val": {
            "0": {
                "precision": 0.9575471698113207,
                "recall": 0.8787878787878788,
                "f1-score": 0.9164785553047404,
                "support": 231.0
            },
            "1": {
                "precision": 0.8901960784313725,
                "recall": 0.961864406779661,
                "f1-score": 0.924643584521385,
                "support": 236.0
            },
            "accuracy": 0.9207708779443254,
            "macro avg": {
                "precision": 0.9238716241213466,
                "recall": 0.9203261427837699,
                "f1-score": 0.9205610699130626,
                "support": 467.0
            },
            "weighted avg": {
                "precision": 0.9235110722402976,
                "recall": 0.9207708779443254,
                "f1-score": 0.9206047799195758,
                "support": 467.0
            },
            "cross-entropy": 0.23644920612397197,
            "roc-auc": 0.9526377577225035,
            "score": 0.9207708779443254
        },
        "test": {
            "0": {
                "precision": 0.9378757515030061,
                "recall": 0.8283185840707965,
                "f1-score": 0.8796992481203008,
                "support": 565.0
            },
            "1": {
                "precision": 0.8358714043993232,
                "recall": 0.940952380952381,
                "f1-score": 0.8853046594982079,
                "support": 525.0
            },
            "accuracy": 0.8825688073394495,
            "macro avg": {
                "precision": 0.8868735779511646,
                "recall": 0.8846354825115887,
                "f1-score": 0.8825019538092543,
                "support": 1090.0
            },
            "weighted avg": {
                "precision": 0.8887452173475625,
                "recall": 0.8825688073394495,
                "f1-score": 0.8823991022243386,
                "support": 1090.0
            },
            "cross-entropy": 0.26320828634056187,
            "roc-auc": 0.9467880320269701,
            "score": 0.8825688073394495
        }
    },
    "train": {
        "metrics": {
            "val": {
                "0": {
                    "precision": 0.957345971563981,
                    "recall": 0.8744588744588745,
                    "f1-score": 0.9140271493212669,
                    "support": 231.0
                },
                "1": {
                    "precision": 0.88671875,
                    "recall": 0.961864406779661,
                    "f1-score": 0.9227642276422764,
                    "support": 236.0
                },
                "accuracy": 0.9186295503211992,
                "macro avg": {
                    "precision": 0.9220323607819905,
                    "recall": 0.9181616406192677,
                    "f1-score": 0.9183956884817717,
                    "support": 467.0
                },
                "weighted avg": {
                    "precision": 0.9216542707307915,
                    "recall": 0.9186295503211992,
                    "f1-score": 0.9184424608496571,
                    "support": 467.0
                },
                "cross-entropy": 0.23344960463313172,
                "roc-auc": 0.9562146892655367,
                "score": 0.9186295503211992
            },
            "train": {}
        },
        "best_step": 10
    },
    "time": "0:00:45.055950",
    "chunk_size": null,
    "eval_batch_size": 4096
}
