{
    "function": "bin.tune.main",
    "gpus": [
        "NVIDIA A100-SXM4-80GB"
    ],
    "config": {
        "seed": 0,
        "function": "bin.tabpfnv2_finetune.main",
        "n_trials": 10,
        "sampler_type": "BruteForceSampler",
        "space": {
            "seed": 0,
            "patience": 16,
            "amp": true,
            "n_epochs": -1,
            "batch_size": 1,
            "epoch_size": 10,
            "seq_len_pred": 512,
            "finetune_mode": "full",
            "model": {
                "untie_pos_embeddings": false,
                "untie_value_embeddings": false,
                "tabpfn_config": {
                    "nhead": 6,
                    "emsize": 192,
                    "nlayers": 12,
                    "nhid_factor": 4
                },
                "num_embeddings": {
                    "type": "LinearEmbeddings"
                }
            },
            "data": {
                "seed": 0,
                "num_policy": "noisy-quantile",
                "cache": true,
                "path": ":data/classif-num-medium-4-phoneme",
                "old": true
            },
            "optimizer": {
                "type": "AdamW",
                "lr": [
                    "_tune_",
                    "categorical",
                    [
                        4.999998054699972e-06,
                        8.340500244230498e-06,
                        1.3912793292547576e-05,
                        2.320794010302052e-05,
                        3.871318040182814e-05,
                        6.457747804233804e-05,
                        0.00010772173118311912,
                        0.00017969068721868098,
                        0.00029974215431138873,
                        0.0005000000819563866
                    ]
                ],
                "weight_decay": 0.0
            }
        }
    },
    "best": {
        "function": "bin.tabpfnv2_finetune.main",
        "gpus": [
            "NVIDIA A100-SXM4-80GB"
        ],
        "config": {
            "seed": 0,
            "patience": 16,
            "amp": true,
            "n_epochs": -1,
            "batch_size": 1,
            "epoch_size": 10,
            "seq_len_pred": 512,
            "finetune_mode": "full",
            "model": {
                "untie_pos_embeddings": false,
                "untie_value_embeddings": false,
                "tabpfn_config": {
                    "nhead": 6,
                    "emsize": 192,
                    "nlayers": 12,
                    "nhid_factor": 4
                },
                "num_embeddings": {
                    "type": "LinearEmbeddings"
                }
            },
            "data": {
                "seed": 0,
                "num_policy": "noisy-quantile",
                "cache": true,
                "path": ":data/classif-num-medium-4-phoneme",
                "old": true
            },
            "optimizer": {
                "type": "AdamW",
                "lr": 3.871318040182814e-05,
                "weight_decay": 0.0
            }
        },
        "n_parameters": 7243978,
        "prediction_type": "probs",
        "metrics": {
            "train": {
                "0": {
                    "precision": 0.9945305378304466,
                    "recall": 0.9837691614066727,
                    "f1-score": 0.9891205802357208,
                    "support": 1109.0
                },
                "1": {
                    "precision": 0.9839715048975958,
                    "recall": 0.9945994599459946,
                    "f1-score": 0.9892569382273948,
                    "support": 1111.0
                },
                "accuracy": 0.9891891891891892,
                "macro avg": {
                    "precision": 0.9892510213640212,
                    "recall": 0.9891843106763336,
                    "f1-score": 0.9891887592315578,
                    "support": 2220.0
                },
                "weighted avg": {
                    "precision": 0.9892462650428804,
                    "recall": 0.9891891891891892,
                    "f1-score": 0.9891888206540764,
                    "support": 2220.0
                },
                "cross-entropy": 0.06160921382387362,
                "roc-auc": 0.9996140732197656,
                "score": 0.9891891891891892
            },
            "val": {
                "0": {
                    "precision": 0.9574468085106383,
                    "recall": 0.9060402684563759,
                    "f1-score": 0.9310344827586207,
                    "support": 149.0
                },
                "1": {
                    "precision": 0.9027777777777778,
                    "recall": 0.9558823529411765,
                    "f1-score": 0.9285714285714286,
                    "support": 136.0
                },
                "accuracy": 0.9298245614035088,
                "macro avg": {
                    "precision": 0.9301122931442081,
                    "recall": 0.9309613106987762,
                    "f1-score": 0.9298029556650247,
                    "support": 285.0
                },
                "weighted avg": {
                    "precision": 0.9313591306872382,
                    "recall": 0.9298245614035088,
                    "f1-score": 0.9298591305850834,
                    "support": 285.0
                },
                "cross-entropy": 0.19905250467047572,
                "roc-auc": 0.9779658507698381,
                "score": 0.9298245614035088
            },
            "test": {
                "0": {
                    "precision": 0.9163987138263665,
                    "recall": 0.8689024390243902,
                    "f1-score": 0.892018779342723,
                    "support": 328.0
                },
                "1": {
                    "precision": 0.8792134831460674,
                    "recall": 0.9233038348082596,
                    "f1-score": 0.9007194244604316,
                    "support": 339.0
                },
                "accuracy": 0.896551724137931,
                "macro avg": {
                    "precision": 0.897806098486217,
                    "recall": 0.8961031369163249,
                    "f1-score": 0.8963691019015774,
                    "support": 667.0
                },
                "weighted avg": {
                    "precision": 0.8974994736455247,
                    "recall": 0.896551724137931,
                    "f1-score": 0.8964408463515733,
                    "support": 667.0
                },
                "cross-entropy": 0.23815772150689998,
                "roc-auc": 0.9664229440966975,
                "score": 0.896551724137931
            }
        },
        "zero-shot-metrics": {
            "val": {
                "0": {
                    "precision": 0.9428571428571428,
                    "recall": 0.8859060402684564,
                    "f1-score": 0.9134948096885813,
                    "support": 149.0
                },
                "1": {
                    "precision": 0.8827586206896552,
                    "recall": 0.9411764705882353,
                    "f1-score": 0.9110320284697508,
                    "support": 136.0
                },
                "accuracy": 0.9122807017543859,
                "macro avg": {
                    "precision": 0.912807881773399,
                    "recall": 0.9135412554283459,
                    "f1-score": 0.9122634190791661,
                    "support": 285.0
                },
                "weighted avg": {
                    "precision": 0.914178549822833,
                    "recall": 0.9122807017543859,
                    "f1-score": 0.9123195877736308,
                    "support": 285.0
                },
                "cross-entropy": 0.232328146471229,
                "roc-auc": 0.9713531385708646,
                "score": 0.9122807017543859
            },
            "test": {
                "0": {
                    "precision": 0.9058441558441559,
                    "recall": 0.850609756097561,
                    "f1-score": 0.8773584905660378,
                    "support": 328.0
                },
                "1": {
                    "precision": 0.8635097493036211,
                    "recall": 0.9144542772861357,
                    "f1-score": 0.8882521489971347,
                    "support": 339.0
                },
                "accuracy": 0.8830584707646177,
                "macro avg": {
                    "precision": 0.8846769525738885,
                    "recall": 0.8825320166918483,
                    "f1-score": 0.8828053197815862,
                    "support": 667.0
                },
                "weighted avg": {
                    "precision": 0.884327868262085,
                    "recall": 0.8830584707646177,
                    "f1-score": 0.8828951475497588,
                    "support": 667.0
                },
                "cross-entropy": 0.2747045908061996,
                "roc-auc": 0.9540389596373839,
                "score": 0.8830584707646177
            }
        },
        "train": {
            "metrics": {
                "val": {
                    "0": {
                        "precision": 0.9507042253521126,
                        "recall": 0.9060402684563759,
                        "f1-score": 0.9278350515463918,
                        "support": 149.0
                    },
                    "1": {
                        "precision": 0.9020979020979021,
                        "recall": 0.9485294117647058,
                        "f1-score": 0.9247311827956989,
                        "support": 136.0
                    },
                    "accuracy": 0.9263157894736842,
                    "macro avg": {
                        "precision": 0.9264010637250073,
                        "recall": 0.9272848401105409,
                        "f1-score": 0.9262831171710453,
                        "support": 285.0
                    },
                    "weighted avg": {
                        "precision": 0.9275096289922086,
                        "recall": 0.9263157894736842,
                        "f1-score": 0.9263539071600961,
                        "support": 285.0
                    },
                    "cross-entropy": 0.19964711647794497,
                    "roc-auc": 0.9773243189893408,
                    "score": 0.9263157894736842
                },
                "train": {}
            },
            "best_step": 20
        },
        "time": "0:00:18.413235",
        "chunk_size": null,
        "eval_batch_size": 4096,
        "trial_id": 2,
        "tuning_time": "0:01:06.075883"
    },
    "time": "0:04:41.110082",
    "n_completed_trials": 10
}
