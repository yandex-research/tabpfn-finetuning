{
    "function": "bin.tune.main",
    "gpus": [
        "NVIDIA A100-SXM4-80GB"
    ],
    "config": {
        "seed": 0,
        "function": "bin.tabpfnv2_finetune.main",
        "n_trials": 10,
        "sampler_type": "BruteForceSampler",
        "space": {
            "seed": 0,
            "patience": 16,
            "amp": true,
            "n_epochs": -1,
            "batch_size": 1,
            "epoch_size": 10,
            "seq_len_pred": 1024,
            "finetune_mode": "full",
            "model": {
                "untie_pos_embeddings": false,
                "untie_value_embeddings": false,
                "tabpfn_config": {
                    "nhead": 6,
                    "emsize": 192,
                    "nlayers": 12,
                    "nhid_factor": 4
                },
                "num_embeddings": {
                    "type": "LinearEmbeddings"
                }
            },
            "data": {
                "seed": 0,
                "num_policy": "noisy-quantile",
                "cache": true,
                "path": ":data/classif-cat-medium-2-KDDCup09_upselling",
                "cat_policy": "ordinal",
                "old": true
            },
            "optimizer": {
                "type": "AdamW",
                "lr": [
                    "_tune_",
                    "categorical",
                    [
                        4.999998054699972e-06,
                        8.340500244230498e-06,
                        1.3912793292547576e-05,
                        2.320794010302052e-05,
                        3.871318040182814e-05,
                        6.457747804233804e-05,
                        0.00010772173118311912,
                        0.00017969068721868098,
                        0.00029974215431138873,
                        0.0005000000819563866
                    ]
                ],
                "weight_decay": 0.0
            }
        }
    },
    "best": {
        "function": "bin.tabpfnv2_finetune.main",
        "gpus": [
            "NVIDIA A100-SXM4-80GB"
        ],
        "config": {
            "seed": 0,
            "patience": 16,
            "amp": true,
            "n_epochs": -1,
            "batch_size": 1,
            "epoch_size": 10,
            "seq_len_pred": 1024,
            "finetune_mode": "full",
            "model": {
                "untie_pos_embeddings": false,
                "untie_value_embeddings": false,
                "tabpfn_config": {
                    "nhead": 6,
                    "emsize": 192,
                    "nlayers": 12,
                    "nhid_factor": 4
                },
                "num_embeddings": {
                    "type": "LinearEmbeddings"
                }
            },
            "data": {
                "seed": 0,
                "num_policy": "noisy-quantile",
                "cache": true,
                "path": ":data/classif-cat-medium-2-KDDCup09_upselling",
                "cat_policy": "ordinal",
                "old": true
            },
            "optimizer": {
                "type": "AdamW",
                "lr": 0.00029974215431138873,
                "weight_decay": 0.0
            }
        },
        "n_parameters": 7243978,
        "prediction_type": "probs",
        "metrics": {
            "train": {
                "0": {
                    "precision": 0.7758707723372035,
                    "recall": 0.8615470852017937,
                    "f1-score": 0.8164674634794157,
                    "support": 1784.0
                },
                "1": {
                    "precision": 0.8463930348258707,
                    "recall": 0.754016620498615,
                    "f1-score": 0.7975388221506007,
                    "support": 1805.0
                },
                "accuracy": 0.8074672610755085,
                "macro avg": {
                    "precision": 0.8111319035815371,
                    "recall": 0.8077818528502043,
                    "f1-score": 0.8070031428150082,
                    "support": 3589.0
                },
                "weighted avg": {
                    "precision": 0.8113382239371043,
                    "recall": 0.8074672610755085,
                    "f1-score": 0.8069477650680166,
                    "support": 3589.0
                },
                "cross-entropy": 0.3377211668158578,
                "roc-auc": 0.9163461299578898,
                "score": 0.8074672610755085
            },
            "val": {
                "0": {
                    "precision": 0.8065693430656934,
                    "recall": 0.8947368421052632,
                    "f1-score": 0.8483685220729367,
                    "support": 247.0
                },
                "1": {
                    "precision": 0.8602150537634409,
                    "recall": 0.7511737089201878,
                    "f1-score": 0.8020050125313283,
                    "support": 213.0
                },
                "accuracy": 0.8282608695652174,
                "macro avg": {
                    "precision": 0.8333921984145671,
                    "recall": 0.8229552755127254,
                    "f1-score": 0.8251867673021325,
                    "support": 460.0
                },
                "weighted avg": {
                    "precision": 0.8314096395409548,
                    "recall": 0.8282608695652174,
                    "f1-score": 0.8269002013504094,
                    "support": 460.0
                },
                "cross-entropy": 0.367450736116254,
                "roc-auc": 0.9093440535249283,
                "score": 0.8282608695652174
            },
            "test": {
                "0": {
                    "precision": 0.7972027972027972,
                    "recall": 0.8587570621468926,
                    "f1-score": 0.8268359020852222,
                    "support": 531.0
                },
                "1": {
                    "precision": 0.8514851485148515,
                    "recall": 0.7875457875457875,
                    "f1-score": 0.8182683158896289,
                    "support": 546.0
                },
                "accuracy": 0.8226555246053854,
                "macro avg": {
                    "precision": 0.8243439728588243,
                    "recall": 0.8231514248463401,
                    "f1-score": 0.8225521089874255,
                    "support": 1077.0
                },
                "weighted avg": {
                    "precision": 0.8247219836618329,
                    "recall": 0.8226555246053854,
                    "f1-score": 0.8224924461309103,
                    "support": 1077.0
                },
                "cross-entropy": 0.3570430213231351,
                "roc-auc": 0.9120292764360561,
                "score": 0.8226555246053854
            }
        },
        "zero-shot-metrics": {
            "val": {
                "0": {
                    "precision": 0.8115384615384615,
                    "recall": 0.854251012145749,
                    "f1-score": 0.8323471400394478,
                    "support": 247.0
                },
                "1": {
                    "precision": 0.82,
                    "recall": 0.7699530516431925,
                    "f1-score": 0.7941888619854721,
                    "support": 213.0
                },
                "accuracy": 0.8152173913043478,
                "macro avg": {
                    "precision": 0.8157692307692308,
                    "recall": 0.8121020318944707,
                    "f1-score": 0.81326800101246,
                    "support": 460.0
                },
                "weighted avg": {
                    "precision": 0.8154565217391304,
                    "recall": 0.8152173913043478,
                    "f1-score": 0.8146781982448895,
                    "support": 460.0
                },
                "cross-entropy": 0.37307269413321786,
                "roc-auc": 0.906027256657353,
                "score": 0.8152173913043478
            },
            "test": {
                "0": {
                    "precision": 0.8003533568904594,
                    "recall": 0.8531073446327684,
                    "f1-score": 0.8258887876025525,
                    "support": 531.0
                },
                "1": {
                    "precision": 0.8473581213307241,
                    "recall": 0.793040293040293,
                    "f1-score": 0.8192999053926207,
                    "support": 546.0
                },
                "accuracy": 0.8226555246053854,
                "macro avg": {
                    "precision": 0.8238557391105917,
                    "recall": 0.8230738188365307,
                    "f1-score": 0.8225943464975866,
                    "support": 1077.0
                },
                "weighted avg": {
                    "precision": 0.8241830703392844,
                    "recall": 0.8226555246053854,
                    "f1-score": 0.8225484629167374,
                    "support": 1077.0
                },
                "cross-entropy": 0.3588014773719799,
                "roc-auc": 0.9105633851396563,
                "score": 0.8226555246053854
            }
        },
        "train": {
            "metrics": {
                "val": {
                    "0": {
                        "precision": 0.8088235294117647,
                        "recall": 0.8906882591093117,
                        "f1-score": 0.8477842003853564,
                        "support": 247.0
                    },
                    "1": {
                        "precision": 0.8563829787234043,
                        "recall": 0.755868544600939,
                        "f1-score": 0.8029925187032418,
                        "support": 213.0
                    },
                    "accuracy": 0.8282608695652174,
                    "macro avg": {
                        "precision": 0.8326032540675845,
                        "recall": 0.8232784018551254,
                        "f1-score": 0.8253883595442991,
                        "support": 460.0
                    },
                    "weighted avg": {
                        "precision": 0.8308456222451978,
                        "recall": 0.8282608695652174,
                        "f1-score": 0.8270437043021164,
                        "support": 460.0
                    },
                    "cross-entropy": 0.3679923321595318,
                    "roc-auc": 0.909857254186387,
                    "score": 0.8282608695652174
                },
                "train": {}
            },
            "best_step": 70
        },
        "time": "0:01:48.907400",
        "chunk_size": null,
        "eval_batch_size": 4096,
        "trial_id": 5,
        "tuning_time": "0:11:47.477461"
    },
    "time": "0:19:42.353918",
    "n_completed_trials": 10
}
